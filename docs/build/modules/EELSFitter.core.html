

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EELSFitter.core package &mdash; EELSFitter 3.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=6f954d08" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=dd1205ac"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="EELSFitter.plotting package" href="EELSFitter.plotting.html" />
    <link rel="prev" title="EELSFitter package" href="EELSFitter.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            EELSFitter
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation/instructions.html">Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/eelsfitter_tutorial.html">EELSfitter tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/cluster.html">Training models in parallel</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Theory</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../theory/clustering_pooling.html">Pooling and clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory/nn_training.html">NN training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory/kk_analysis.html">Kramers-Kronig analysis of EEL spectra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory/band_gap_analysis.html">Band gap analysis</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Key Results</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../key_results/Roest2021.html">Charting the low-loss region in Electron Energy Loss Spectroscopy with machine learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../key_results/vanHeijst2021.html">Illuminating the Electronic Properties of WS<sub>2</sub> Polytypism with Electron Microscopy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../key_results/Brokkelkamp2022.html">Spatially-resolved band gap and dielectric function in 2D materials from Electron Energy Loss Spectroscopy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../key_results/vanderLippe2023.html">Localized exciton anatomy and band gap energy modulation in 1D MoS<sub>2</sub> nanostructures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../key_results/La2023.html">Edge-induced excitations in Bi<sub>2</sub>Te<sub>3</sub> from spatially-resolved electron energy-gain spectroscopy</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Code</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="EELSFitter.html">EELSFitter package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="EELSFitter.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">EELSFitter.core package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#module-EELSFitter.core.spectral_image">EELSFitter.core.spectral_image module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-EELSFitter.core.training">EELSFitter.core.training module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-EELSFitter.core.gainpeakfitter">EELSFitter.core.gainpeakfitter module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="EELSFitter.plotting.html">EELSFitter.plotting package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="EELSFitter.html#meta">Meta</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Bibliography</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">EELSFitter</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="EELSFitter.html">EELSFitter package</a></li>
      <li class="breadcrumb-item active">EELSFitter.core package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/modules/EELSFitter.core.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="eelsfitter-core-package">
<h1>EELSFitter.core package<a class="headerlink" href="#eelsfitter-core-package" title="Link to this heading"></a></h1>
<section id="module-EELSFitter.core.spectral_image">
<span id="eelsfitter-core-spectral-image-module"></span><h2>EELSFitter.core.spectral_image module<a class="headerlink" href="#module-EELSFitter.core.spectral_image" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">EELSFitter.core.spectral_image.</span></span><span class="sig-name descname"><span class="pre">SpectralImage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deltaE</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collection_angle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convergence_angle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.KK_pixel">
<span class="sig-name descname"><span class="pre">KK_pixel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'EELS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mat_prop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'n'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.KK_pixel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.KK_pixel" title="Link to this definition"></a></dt>
<dd><p>Perform a Kramer-Krönig analysis on pixel (<code class="docutils literal notranslate"><span class="pre">i</span></code>, <code class="docutils literal notranslate"><span class="pre">j</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – y-coordinate of the pixel</p></li>
<li><p><strong>j</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – x-coordinate of the pixel.</p></li>
<li><p><strong>signal_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Type of spectrum. Set to ‘EELS’ by default.</p></li>
<li><p><strong>iterations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of the iterations for the internal loop to remove the
surface plasmon contribution. If 1 the surface plasmon contribution
is not estimated and subtracted (the default is 1).</p></li>
<li><p><strong>mat_prop</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Material property to be used for calculations, ‘n’ refers to refractive index, ‘rho’ refers to mass density.
Set to ‘n’ by default</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>dielectric_functions</strong> (<em>numpy.ndarray, shape=(M,)</em>) – Collection dielectric-functions replicas at pixel (<code class="docutils literal notranslate"><span class="pre">i</span></code>, <code class="docutils literal notranslate"><span class="pre">j</span></code>).</p></li>
<li><p><strong>ts</strong> (<em>float</em>) – Thickness.</p></li>
<li><p><strong>S_ss</strong> (<em>array_like</em>) – Surface scatterings.</p></li>
<li><p><strong>signal_ssds</strong> (<em>array_like</em>) – Deconvoluted EELS spectrum.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.calc_axes">
<span class="sig-name descname"><span class="pre">calc_axes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.calc_axes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.calc_axes" title="Link to this definition"></a></dt>
<dd><p>Determines the x_axis and y_axis of the spectral image. Stores them in
<code class="docutils literal notranslate"><span class="pre">self.x_axis</span></code> and <code class="docutils literal notranslate"><span class="pre">self.y_axis</span></code> respectively.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.calc_thickness">
<span class="sig-name descname"><span class="pre">calc_thickness</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_zlp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.calc_thickness"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.calc_thickness" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Calculates thickness from sample data by one of two methods:</dt><dd><ul class="simple">
<li><p>Kramer-Kronig sum rule using the refractive index <span id="id1">[<a class="reference internal" href="../bibliography.html#id14" title="R.F. Egerton and S.C. Cheng. Measurement of local thickness by electron energy-loss spectroscopy. Ultramicroscopy, 21(3):231-244, 1987. doi:https://doi.org/10.1016/0304-3991(87)90148-3.">Egerton and Cheng, 1987</a>]</span></p></li>
<li><p>Log ratio using mass density <span id="id2">[<a class="reference internal" href="../bibliography.html#id15" title="K. Iakoubovskii, K. Mitsuishi, Y. Nakayama, and K. Furuya. Thickness measurements with electron energy loss spectroscopy. Microscopy Research and Technique, 71(8):626-631, 2008. doi:https://doi.org/10.1002/jemt.20597.">Iakoubovskii <em>et al.</em>, 2008</a>]</span></p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a><em>, </em><em>shape=</em><em>(</em><em>M</em><em>,</em><em>)</em>) – spectrum</p></li>
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – refraction index</p></li>
<li><p><strong>rho</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – mass density</p></li>
<li><p><strong>n_zlp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Set to 1 by default, for already normalized EELS spectra.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>t</strong> – thickness</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If using the refractive index, surface scatterings are not corrected for.
If you wish to correct for surface scatterings, please extract the thickness <code class="docutils literal notranslate"><span class="pre">t</span></code> from
<a class="reference internal" href="#EELSFitter.core.spectral_image.SpectralImage.kramers_kronig_analysis" title="EELSFitter.core.spectral_image.SpectralImage.kramers_kronig_analysis"><code class="xref py py-meth docutils literal notranslate"><span class="pre">kramers_kronig_analysis()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.cluster">
<span class="sig-name descname"><span class="pre">cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_clusters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">based_on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'log_zlp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k-means++'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_times</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lloyd'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.cluster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.cluster" title="Link to this definition"></a></dt>
<dd><p>Clusters the spectral image into clusters according to the (log)
integrated intensity at each pixel. Cluster means are stored in the
attribute <code class="docutils literal notranslate"><span class="pre">self.cluster_centroids</span></code>. This is then passed on to the
cluster_on_centroids function where the index to which each cluster belongs
is stored in the attribute <code class="docutils literal notranslate"><span class="pre">self.cluster_labels</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_clusters</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Number of clusters, 5 by default</p></li>
<li><p><strong>based_on</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – One can cluster either on the sum of the intensities (pass <code class="docutils literal notranslate"><span class="pre">'sum'</span></code>),
the log of the sum (pass <code class="docutils literal notranslate"><span class="pre">'log_sum'</span></code>),
the log of the ZLP peak value (pass <code class="docutils literal notranslate"><span class="pre">'log_peak'</span></code>),
the log of the ZLP peak value + the two bins next to the peak value (pass <code class="docutils literal notranslate"><span class="pre">'log_zlp'</span></code>),
the log of the sum of the bulk spectrum (no zlp) (pass <code class="docutils literal notranslate"><span class="pre">'log_bulk'</span></code>),
the thickness (pass <code class="docutils literal notranslate"><span class="pre">'thickness'</span></code>).
The default is <code class="docutils literal notranslate"><span class="pre">'log_zlp'</span></code>.</p></li>
<li><p><strong>init</strong> (<em>{'k-means++'</em><em>, </em><em>'random'}</em><em>, </em><em>callable</em><em> or </em><em>array-like</em><em> of </em><em>shape </em>) – (n_clusters, n_features), default=’k-means++’</p></li>
<li><p><strong>n_times</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default=10</em>) – Number of time the k-means algorithm will be run with different
centroid seeds. The final results will be the best output of
n_init consecutive runs in terms of inertia.</p></li>
<li><p><strong>max_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default=300</em>) – Maximum number of iterations of the k-means algorithm for a
single run.</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>None</em><em>, </em><em>default=None</em>) – Determines random number generation for centroid initialization. Use
an int to make the randomness deterministic.</p></li>
<li><p><strong>save_seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default=False</em>) – save the seed with corresponding settings to get to the same result</p></li>
<li><p><strong>algorithm</strong> (<em>{'lloyd'</em><em>, </em><em>'elkan'}</em><em>, </em><em>default='lloyd'</em>) – K-means algorithm to use. The classical EM-style algorithm is <code class="docutils literal notranslate"><span class="pre">'lloyd'</span></code>.
The <code class="docutils literal notranslate"><span class="pre">'elkan'</span></code> variation can be more efficient on some datasets with
well-defined clusters, by using the triangle inequality. However, it’s
more memory intensive due to the allocation of an extra array of shape
<cite>(n_samples, n_clusters)</cite>.</p></li>
<li><p><strong>kwargs</strong></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.cluster_on_centroids">
<span class="sig-name descname"><span class="pre">cluster_on_centroids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cluster_centroids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">based_on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'log_zlp'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.cluster_on_centroids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.cluster_on_centroids" title="Link to this definition"></a></dt>
<dd><p>If the image has been clustered before and the cluster centroids are
already known, one can use this function to reconstruct the original
clustering of the image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cluster_centroids</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a><em>, </em><em>shape=</em><em>(</em><em>M</em><em>,</em><em>)</em>) – Array with the cluster centroids</p></li>
<li><p><strong>based_on</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – One can cluster either on the sum of the intensities (pass <code class="docutils literal notranslate"><span class="pre">'sum'</span></code>),
the log of the sum (pass <code class="docutils literal notranslate"><span class="pre">'log_sum'</span></code>),
the log of the ZLP peak value (pass <code class="docutils literal notranslate"><span class="pre">'log_peak'</span></code>),
the log of the ZLP peak value + the two bins next to the peak value (pass <code class="docutils literal notranslate"><span class="pre">'log_zlp'</span></code>),
the log of the sum of the bulk spectrum (no zlp) (pass <code class="docutils literal notranslate"><span class="pre">'log_bulk'</span></code>),
the thickness (pass <code class="docutils literal notranslate"><span class="pre">'thickness'</span></code>).
The default is <code class="docutils literal notranslate"><span class="pre">'log_zlp'</span></code>.</p></li>
<li><p><strong>kwargs</strong></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.compressed_pickle">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">compressed_pickle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.compressed_pickle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.compressed_pickle" title="Link to this definition"></a></dt>
<dd><p>Saves <code class="docutils literal notranslate"><span class="pre">data</span></code> at location <code class="docutils literal notranslate"><span class="pre">title</span></code> as compressed pickle.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.cut_image_energy">
<span class="sig-name descname"><span class="pre">cut_image_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_edge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.cut_image_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.cut_image_energy" title="Link to this definition"></a></dt>
<dd><p>Cuts the spectral image at <code class="docutils literal notranslate"><span class="pre">E1</span></code> and <code class="docutils literal notranslate"><span class="pre">E2</span></code> and keeps only the part in between.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>e1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – lower cut. The default is <code class="docutils literal notranslate"><span class="pre">None</span></code>, which means no cut is applied.</p></li>
<li><p><strong>e2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – upper cut. The default is <code class="docutils literal notranslate"><span class="pre">None</span></code>, which means no cut is applied.</p></li>
<li><p><strong>include_edge</strong> (<em>Boolean</em><em>, </em><em>optional</em>) – If True, the edge values given in <code class="docutils literal notranslate"><span class="pre">E1</span></code> and <code class="docutils literal notranslate"><span class="pre">E2</span></code> are included in the cut result. Default is True</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.cut_image_pixels">
<span class="sig-name descname"><span class="pre">cut_image_pixels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">range_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range_height</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.cut_image_pixels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.cut_image_pixels" title="Link to this definition"></a></dt>
<dd><p>Cuts the spectral image</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>range_width</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a><em>, </em><em>shape=</em><em>(</em><em>2</em><em>,</em><em>)</em>) – Contains the horizontal selection cut</p></li>
<li><p><strong>range_height</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a><em>, </em><em>shape=</em><em>(</em><em>2</em><em>,</em><em>)</em>) – Contains the vertical selection cut</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.decompress_pickle">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">decompress_pickle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.decompress_pickle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.decompress_pickle" title="Link to this definition"></a></dt>
<dd><p>Opens, decompresses and returns the pickle file at location <code class="docutils literal notranslate"><span class="pre">file</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – location where the pickle file is stored</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>data</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#EELSFitter.core.spectral_image.SpectralImage" title="EELSFitter.core.spectral_image.SpectralImage">SpectralImage</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.deconv_image">
<span class="sig-name descname"><span class="pre">deconv_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'EELS'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.deconv_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.deconv_image" title="Link to this definition"></a></dt>
<dd><p>Deconvolute the signals of all pixels. Only the median value of the ZLP models is taken.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kwargs</strong></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.deconvolution">
<span class="sig-name descname"><span class="pre">deconvolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zlp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.deconvolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.deconvolution" title="Link to this definition"></a></dt>
<dd><p>Perform deconvolution on a given signal with a given Zero Loss Peak. This removes both the ZLP and plural
scattering. Based on the Fourier Log Method <span id="id3">[<a class="reference internal" href="../bibliography.html#id16" title="D W Johnson and J C H Spence. Determination of the single-scattering probability distribution from plural-scattering data. Journal of Physics D: Applied Physics, 7(6):771, apr 1974. doi:https://doi.org/10.1088/0022-3727/7/6/304.">Johnson and Spence, 1974</a>, <a class="reference internal" href="../bibliography.html#id13" title="Ray Egerton. Electron Energy-Loss Spectroscopy in the Electron Microscope, 3rd Edition (Springer, 2011). Springer Science &amp; Business Media, 01 2011. ISBN 978-1-4419-9582-7. doi:https://doi.org/10.1007/978-1-4419-9583-4.">Egerton, 2011</a>]</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a><em>, </em><em>shape=</em><em>(</em><em>M</em><em>,</em><em>)</em>) – Raw signal of length M</p></li>
<li><p><strong>zlp</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a><em>, </em><em>shape=</em><em>(</em><em>M</em><em>,</em><em>)</em>) – zero-loss peak of length M</p></li>
<li><p><strong>correction</strong> (<em>Bool</em>) – Sometimes a decreasing linear slope occurs on the place of the ZLP after deconvolution. This correction fits
a linear function and subtracts that from the signal. Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>output</strong> – deconvoluted spectrum.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a>, shape=(M,)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.extrp_signal">
<span class="sig-name descname"><span class="pre">extrp_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.extrp_signal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.extrp_signal" title="Link to this definition"></a></dt>
<dd><p>Extrapolate your signal. Extrapolation model, generate vanishing to zero data after the real exp. data
See Egerton paragraph 4.2.2 for details. extrapolation of the form A*E^-r is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a><em>, </em><em>shape=</em><em>(</em><em>M</em><em>,</em><em>)</em>) – spectrum</p></li>
<li><p><strong>r</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – extrapolation parameter</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.find_optimal_amount_of_clusters">
<span class="sig-name descname"><span class="pre">find_optimal_amount_of_clusters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_clusters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">based_on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'log_zlp'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.find_optimal_amount_of_clusters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.find_optimal_amount_of_clusters" title="Link to this definition"></a></dt>
<dd><p>Find the optimal amount of clusters by performing a Gaussian Mixture model on the specific data intensities.
The user will need to judge what is best</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_clusters</strong></p></li>
<li><p><strong>bins</strong></p></li>
<li><p><strong>based_on</strong></p></li>
<li><p><strong>kwargs</strong></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>fig</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.get_cluster_signals">
<span class="sig-name descname"><span class="pre">get_cluster_signals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conf_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'EELS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'EELS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.get_cluster_signals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.get_cluster_signals" title="Link to this definition"></a></dt>
<dd><p>Get the signals ordered per cluster. Cluster signals are stored in attribute <code class="docutils literal notranslate"><span class="pre">self.cluster_signals</span></code>.
Note that the pixel location information is lost.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>conf_interval</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – The ratio of spectra returned. The spectra are selected based on the
based_on value. The default is 1.</p></li>
<li><p><strong>signal_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Description of signal, <code class="docutils literal notranslate"><span class="pre">'EELS'</span></code> by default.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>cluster_signals</strong> – An array with size equal to the number of clusters. Each entry is a
2D array that contains all the spectra within that cluster.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a>, shape=(M,)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.get_extrp_param">
<span class="sig-name descname"><span class="pre">get_extrp_param</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range_perc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.get_extrp_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.get_extrp_param" title="Link to this definition"></a></dt>
<dd><p>Retrieve the extrapolation parameter from the last 10% of a given signal</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a><em>, </em><em>shape=</em><em>(</em><em>M</em><em>,</em><em>)</em>)</p></li>
<li><p><strong>range_perc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>r</strong> – extrapolation parameter</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.get_image_signals">
<span class="sig-name descname"><span class="pre">get_image_signals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'EELS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'EELS'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.get_image_signals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.get_image_signals" title="Link to this definition"></a></dt>
<dd><p>Get all the signals of the image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Description of signal, <code class="docutils literal notranslate"><span class="pre">'EELS'</span></code> by default.</p></li>
<li><p><strong>kwargs</strong></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>image_signals</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a>, shape=(M,N)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.get_pixel_matched_zlp_models">
<span class="sig-name descname"><span class="pre">get_pixel_matched_zlp_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'EELS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.get_pixel_matched_zlp_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.get_pixel_matched_zlp_models" title="Link to this definition"></a></dt>
<dd><p>Returns the shape-(M, N) array of matched ZLP model predictions at pixel
(<code class="docutils literal notranslate"><span class="pre">i</span></code>, <code class="docutils literal notranslate"><span class="pre">j</span></code>) after training. M and N correspond to the number of model
predictions and <span class="math notranslate nohighlight">\(\Delta E\)</span> s respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – y-coordinate of the pixel.</p></li>
<li><p><strong>j</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – x-coordinate of the pixel.</p></li>
<li><p><strong>signal_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Description of signal type. Set to <code class="docutils literal notranslate"><span class="pre">'EELS'</span></code> by default.</p></li>
<li><p><strong>signal</strong> (<em>array</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>,</em>) – signal you want to match the zlps to. Important to do if you did not do any pooling, pca or nmf on the whole
image, otherwise it will calculate the denoised signal twice.</p></li>
<li><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The matched ZLP predictions at pixel (<code class="docutils literal notranslate"><span class="pre">i</span></code>, <code class="docutils literal notranslate"><span class="pre">j</span></code>).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a>, shape=(M, N)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.get_pixel_signal">
<span class="sig-name descname"><span class="pre">get_pixel_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'EELS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'EELS'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.get_pixel_signal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.get_pixel_signal" title="Link to this definition"></a></dt>
<dd><p>Retrieves the spectrum at pixel (<code class="docutils literal notranslate"><span class="pre">i</span></code>, <code class="docutils literal notranslate"><span class="pre">j</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – y-coordinate of the pixel</p></li>
<li><p><strong>j</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – x-coordinate of the pixel</p></li>
<li><p><strong>signal_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – The type of signal that is requested, should comply with the defined
names. Set to <cite>EELS</cite> by default.</p></li>
<li><p><strong>subtract_zlps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If <cite>True</cite>, subtract the zlps from the signal, only possible if zlp models are available. Note that the
median will be taken from the zlps. Set to <cite>False</cite> by default.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>signal</strong> – Array with the requested signal from the requested pixel</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a>, shape=(M,)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.get_prefix">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_prefix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SIunit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numeric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.get_prefix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.get_prefix" title="Link to this definition"></a></dt>
<dd><p>Method to convert units to their associated SI values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>unit</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>,</em>) – unit of which the prefix is requested</p></li>
<li><p><strong>SIunit</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – The SI unit of the unit</p></li>
<li><p><strong>numeric</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Default is <cite>True</cite>. If <cite>True</cite> the prefix is translated to the
numeric value (e.g. <span class="math notranslate nohighlight">\(10^3\)</span> for <cite>k</cite>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>prefix</strong> – The character of the prefix or the numeric value of the prefix</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.get_zlp_models">
<span class="sig-name descname"><span class="pre">get_zlp_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">int_i</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.get_zlp_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.get_zlp_models" title="Link to this definition"></a></dt>
<dd><p>Returns the shape-(M, N) array of zlp model predictions at the
integrated intensity <code class="docutils literal notranslate"><span class="pre">int_i</span></code>. The logarithm of the integrated intensity is taken,
as the data is always trained to log of the signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>int_i</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Integrated intensity</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.kramers_kronig_analysis">
<span class="sig-name descname"><span class="pre">kramers_kronig_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal_ssd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_zlp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.kramers_kronig_analysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.kramers_kronig_analysis" title="Link to this definition"></a></dt>
<dd><p>Computes the complex dielectric function from the single scattering distribution (SSD) <code class="docutils literal notranslate"><span class="pre">signal_ssd</span></code> following
the Kramers-Krönig relations. This code is based on Egerton’s MATlab code <span id="id4">[<a class="reference internal" href="../bibliography.html#id13" title="Ray Egerton. Electron Energy-Loss Spectroscopy in the Electron Microscope, 3rd Edition (Springer, 2011). Springer Science &amp; Business Media, 01 2011. ISBN 978-1-4419-9582-7. doi:https://doi.org/10.1007/978-1-4419-9583-4.">Egerton, 2011</a>]</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal_ssd</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a><em>, </em><em>shape=</em><em>(</em><em>M</em><em>,</em><em>)</em>) – SSD of length energy-loss (M)</p></li>
<li><p><strong>n_zlp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Total integrated intensity of the ZLP</p></li>
<li><p><strong>iterations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of the iterations for the internal loop to remove the
surface plasmon contribution. If 1 the surface plasmon contribution
is not estimated and subtracted (the default is 1).</p></li>
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The medium refractive index. Used for normalization of the
SSD to obtain the energy loss function. If given the thickness
is estimated and returned. It is only required when <cite>t</cite> is None.</p></li>
<li><p><strong>t</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The sample thickness in nm.</p></li>
<li><p><strong>delta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Factor added to aid stability for calculating surface losses</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul>
<li><p><strong>eps</strong> (<em>numpy.ndarray</em>) –</p>
<p>The complex dielectric function,</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\epsilon = \epsilon_1 + i*\epsilon_2,\]</div>
</div></blockquote>
</li>
<li><p><strong>te</strong> (<em>float</em>) – local thickness</p></li>
<li><p><strong>srf_int</strong> (<em>numpy.ndarray</em>) – Surface losses correction</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Relativistic effects are not considered when correcting surface scattering.</p></li>
<li><p>The value of delta depends on the thickness of your sample and is qualitatively determined by how realistic
the output is.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.load_compressed_Spectral_image">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_compressed_Spectral_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path_to_compressed_pickle</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.load_compressed_Spectral_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.load_compressed_Spectral_image" title="Link to this definition"></a></dt>
<dd><p>Loads spectral image from a compressed pickled file. This will take longer than loading from non-compressed
pickle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path_to_compressed_pickle</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – path to the compressed pickle image file.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If path_to_compressed_pickle does not end on the desired format .pbz2.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#FileNotFoundError" title="(in Python v3.13)"><strong>FileNotFoundError</strong></a> – If path_to_compressed_pickle does not exist.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>image</strong> – <a class="reference internal" href="#EELSFitter.core.spectral_image.SpectralImage" title="EELSFitter.core.spectral_image.SpectralImage"><code class="xref py py-meth docutils literal notranslate"><span class="pre">spectral_image.SpectralImage</span></code></a> instance
loaded from the compressed pickle file.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#EELSFitter.core.spectral_image.SpectralImage" title="EELSFitter.core.spectral_image.SpectralImage">SpectralImage</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.load_dmfile">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_dmfile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path_to_dmfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_survey_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.load_dmfile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.load_dmfile" title="Link to this definition"></a></dt>
<dd><p>Load the .dm4 (or .dm3) data and return a
<a class="reference internal" href="#EELSFitter.core.spectral_image.SpectralImage" title="EELSFitter.core.spectral_image.SpectralImage"><code class="xref py py-meth docutils literal notranslate"><span class="pre">spectral_image.SpectralImage</span></code></a> instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path_to_dmfile</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – location of .dm4 file</p></li>
<li><p><strong>load_survey_data</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If there is HAADF survey data in your file, you can choose to also load that in. Default is <cite>False</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#EELSFitter.core.spectral_image.SpectralImage" title="EELSFitter.core.spectral_image.SpectralImage"><code class="xref py py-meth docutils literal notranslate"><span class="pre">spectral_image.SpectralImage</span></code></a>
instance of the dm4 file</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#EELSFitter.core.spectral_image.SpectralImage" title="EELSFitter.core.spectral_image.SpectralImage">SpectralImage</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.load_spectral_image">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_spectral_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path_to_pickle</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.load_spectral_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.load_spectral_image" title="Link to this definition"></a></dt>
<dd><p>Loads <a class="reference internal" href="#EELSFitter.core.spectral_image.SpectralImage" title="EELSFitter.core.spectral_image.SpectralImage"><code class="xref py py-meth docutils literal notranslate"><span class="pre">spectral_image.SpectralImage</span></code></a> instance
from a pickled file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path_to_pickle</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – path to the pickled image file.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If path_to_pickle does not end on the desired format .pkl.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#FileNotFoundError" title="(in Python v3.13)"><strong>FileNotFoundError</strong></a> – If path_to_pickle does not exist.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#EELSFitter.core.spectral_image.SpectralImage" title="EELSFitter.core.spectral_image.SpectralImage"><code class="xref py py-meth docutils literal notranslate"><span class="pre">spectral_image.SpectralImage</span></code></a> object
(i.e. including all attributes) loaded from pickle file.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#EELSFitter.core.spectral_image.SpectralImage" title="EELSFitter.core.spectral_image.SpectralImage">SpectralImage</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.load_zlp_models">
<span class="sig-name descname"><span class="pre">load_zlp_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path_to_models</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_chi2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.load_zlp_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.load_zlp_models" title="Link to this definition"></a></dt>
<dd><p>Loads the trained ZLP models and stores them in <code class="docutils literal notranslate"><span class="pre">self.zlp_models</span></code>.
Models that have a <span class="math notranslate nohighlight">\(\chi^2 &gt; \chi^2_{\mathrm{mean}} + 5\sigma\)</span> are
discarded, where <span class="math notranslate nohighlight">\(\sigma\)</span> denotes the 68% CI.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path_to_models</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Location where the model predictions have been stored after training.</p></li>
<li><p><strong>plot_chi2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – When set to <cite>True</cite>, plot and save the <span class="math notranslate nohighlight">\(\chi^2\)</span> distribution.</p></li>
<li><p><strong>plot_pred</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – When set to <cite>True</cite>, plot and save the ZLP predictions per cluster.</p></li>
<li><p><strong>idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – When specified, only the zlp labelled by <code class="docutils literal notranslate"><span class="pre">idx</span></code> is loaded, instead
of all model predictions.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.match_zlp_to_signal">
<span class="sig-name descname"><span class="pre">match_zlp_to_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zlp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">de1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">de2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.match_zlp_to_signal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.match_zlp_to_signal" title="Link to this definition"></a></dt>
<dd><p>Apply the matching to the subtracted spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a><em>, </em><em>shape=</em><em>(</em><em>M</em><em>,</em><em>)</em>) – Signal to be matched</p></li>
<li><p><strong>zlp</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a><em>, </em><em>shape=</em><em>(</em><em>M</em><em>,</em><em>)</em>) – ZLP model to be matched, must match length of Signal.</p></li>
<li><p><strong>de1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Value of the hyperparameter <span class="math notranslate nohighlight">\(\Delta E_{I}\)</span></p></li>
<li><p><strong>de2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Value of the hyperparameter <span class="math notranslate nohighlight">\(\Delta E_{II}\)</span></p></li>
<li><p><strong>fwhm</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Value of the hyperparameter <span class="math notranslate nohighlight">\(FWHM\)</span>. If none is given, a fwhm is determined from the signal.
Default is None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>output</strong> – Matched ZLP model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a>, shape=(M,)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.n_clusters">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_clusters</span></span><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.n_clusters" title="Link to this definition"></a></dt>
<dd><p>Returns the number of clusters in the
<a class="reference internal" href="#EELSFitter.core.spectral_image.SpectralImage" title="EELSFitter.core.spectral_image.SpectralImage"><code class="xref py py-meth docutils literal notranslate"><span class="pre">spectral_image.SpectralImage</span></code></a> object.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.n_spectra">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_spectra</span></span><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.n_spectra" title="Link to this definition"></a></dt>
<dd><p>Returns the number of spectra present in
<a class="reference internal" href="#EELSFitter.core.spectral_image.SpectralImage" title="EELSFitter.core.spectral_image.SpectralImage"><code class="xref py py-meth docutils literal notranslate"><span class="pre">spectral_image.SpectralImage</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.nmf_cluster">
<span class="sig-name descname"><span class="pre">nmf_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_poisson</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.nmf_cluster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.nmf_cluster" title="Link to this definition"></a></dt>
<dd><p>Use non-negative matrix factorization on a cluster of the spectral image.
The signals of the cluster are already in reduced format (pixel location is lost).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cluster</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a><em>, </em><em>shape=</em><em>(</em><em>M</em><em>,</em><em>)</em>) – An array with size equal to the number of clusters. Each entry is a
2D array that contains all the spectra within that cluster.</p></li>
<li><p><strong>n_components</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>,</em>) – number components to calculate. If between 0 and 1 the amount of components will be determined based on the
sum of the variance of the components below the given value by PCA first. Default is 0.9.</p></li>
<li><p><strong>max_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>,</em>) – Default is 100000</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.nmf_image">
<span class="sig-name descname"><span class="pre">nmf_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'segment'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">segments_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">segments_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_poisson</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.nmf_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.nmf_image" title="Link to this definition"></a></dt>
<dd><p>Use non-negative matrix factorization on the spectral image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>area_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <dl class="simple">
<dt>type of area used for principal component analysis. Usage types as follows:</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'segment'</span></code>, the image is segmented and nmf is only done per segmented areas.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'cluster'</span></code>, the data per cluster is used for nmf within that cluster.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pixel'</span></code>, only the data used around a pixel is used for nmf of that pixel.</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>n_components</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>,</em>) – number components to calculate. If between 0 and 1 the amount of components will be determined based on the
sum of the variance of the components below the given value by first running PCA. Default is 0.9.</p></li>
<li><p><strong>max_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>,</em>) – Default is 100000</p></li>
<li><p><strong>segments_x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – For <code class="docutils literal notranslate"><span class="pre">'segment'</span></code> option, number of segments the x-axis is divided upon. Default is 1.</p></li>
<li><p><strong>segments_y</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – For <code class="docutils literal notranslate"><span class="pre">'segment'</span></code> option, number of segments the y-axis is divided upon. Default is 1.</p></li>
<li><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – Additional keyword arguments.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.nmf_pixel">
<span class="sig-name descname"><span class="pre">nmf_pixel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_poisson</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.nmf_pixel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.nmf_pixel" title="Link to this definition"></a></dt>
<dd><p>Use principal component analysis on the spectral image, using the data of a squared window of size <code class="docutils literal notranslate"><span class="pre">n_p</span></code>
around pixel (<code class="docutils literal notranslate"><span class="pre">i</span></code>, <code class="docutils literal notranslate"><span class="pre">j</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – y-coordinate of the pixel</p></li>
<li><p><strong>j</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – x-coordinate of the pixel</p></li>
<li><p><strong>area</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – PCA area parameter. Area around the pixel used for principal component analysis, must be an odd number</p></li>
<li><p><strong>n_components</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>,</em>) – number components to calculate. If between 0 and 1 the amount of components will be determined based on the
sum of the variance of the components below the given value by PCA first. Default is 0.9.</p></li>
<li><p><strong>max_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>,</em>) – Default is 100000</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>output</strong> – PCA spectrum of the pixel</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a>, shape=(M,)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.pca_cluster">
<span class="sig-name descname"><span class="pre">pca_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_poisson</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.pca_cluster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.pca_cluster" title="Link to this definition"></a></dt>
<dd><p>Use principal component analysis on a cluster of the spectral image. The signals of the cluster are already
in reduced format (pixel location is lost).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cluster</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a><em>, </em><em>shape=</em><em>(</em><em>M</em><em>,</em><em>)</em>) – An array with size equal to the number of clusters. Each entry is a 2D array that contains all the spectra
within that cluster.</p></li>
<li><p><strong>n_components</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>,</em>) – number components to calculate. If between 0 and 1 the amount of components will be determined based on the
sum of the variance of the components below the given value. Default is 0.9.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.pca_image">
<span class="sig-name descname"><span class="pre">pca_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'segment'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">segments_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">segments_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_poisson</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.pca_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.pca_image" title="Link to this definition"></a></dt>
<dd><p>Use principal component analysis on the spectral image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>area_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <dl class="simple">
<dt>type of area used for principal component analysis. Usage types as follows:</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'segment'</span></code>, the image is segmented and pca is only done per segmented areas.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'cluster'</span></code>, the data per cluster is used for pca within that cluster.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pixel'</span></code>, only the data used around a pixel is used for pca of that pixel.</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>n_components</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>,</em>) – number components to calculate. If between 0 and 1 the amount of components will be determined based on the
sum of the variance of the components below the given value. Default is 0.9.</p></li>
<li><p><strong>segments_x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – For <code class="docutils literal notranslate"><span class="pre">'segment'</span></code> option, number of segments the x-axis is divided upon. Default is 1.</p></li>
<li><p><strong>segments_y</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – For <code class="docutils literal notranslate"><span class="pre">'segment'</span></code> option, number of segments the y-axis is divided upon. Default is 1.</p></li>
<li><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – Additional keyword arguments.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.pca_pixel">
<span class="sig-name descname"><span class="pre">pca_pixel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_poisson</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.pca_pixel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.pca_pixel" title="Link to this definition"></a></dt>
<dd><p>Use principal component analysis on the spectral image, using the data of a squared window of size <code class="docutils literal notranslate"><span class="pre">n_p</span></code>
around pixel (<code class="docutils literal notranslate"><span class="pre">i</span></code>, <code class="docutils literal notranslate"><span class="pre">j</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – y-coordinate of the pixel</p></li>
<li><p><strong>j</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – x-coordinate of the pixel</p></li>
<li><p><strong>area</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – PCA area parameter. Area around the pixel used for principal component analysis, must be an odd number</p></li>
<li><p><strong>n_components</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>,</em>) – number components to calculate. If between 0 and 1 the amount of components will be determined based on the
sum of the variance of the components below the given value. Default is 0.9.</p></li>
<li><p><strong>deconv</strong></p></li>
<li><p><strong>zlp_num</strong></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>output</strong> – PCA spectrum of the pixel</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a>, shape=(M,)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.pool_image">
<span class="sig-name descname"><span class="pre">pool_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.pool_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.pool_image" title="Link to this definition"></a></dt>
<dd><p>Pools spectral image using a squared window of size <code class="docutils literal notranslate"><span class="pre">area</span></code> around each pixel</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a><em> (</em><em>M</em><em>,</em><em>N</em><em>)</em>) – 2D data set.</p></li>
<li><p><strong>area</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Pooling parameter: area around the pixel, must be an odd number</p></li>
<li><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – Additional keyword arguments.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.pool_pixel">
<span class="sig-name descname"><span class="pre">pool_pixel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaussian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.pool_pixel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.pool_pixel" title="Link to this definition"></a></dt>
<dd><p>Pools the data of a squared window of size <code class="docutils literal notranslate"><span class="pre">area</span></code> around pixel (<code class="docutils literal notranslate"><span class="pre">i</span></code>, <code class="docutils literal notranslate"><span class="pre">j</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – y-coordinate of the pixel</p></li>
<li><p><strong>j</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – x-coordinate of the pixel</p></li>
<li><p><strong>area</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Pooling parameter: area around the pixel used for pooling, must be an odd number</p></li>
<li><p><strong>gaussian</strong> (<em>boolean</em>) – If true the pooling weights will use a gaussian distribution</p></li>
<li><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>output</strong> – Pooled spectrum of the pixel</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a>, shape=(M,)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.rl_deconvolution">
<span class="sig-name descname"><span class="pre">rl_deconvolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zlp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.rl_deconvolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.rl_deconvolution" title="Link to this definition"></a></dt>
<dd><p>Richardson-lucy deconvolution
:param signal:
:param zlp:
:param iterations:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.save_compressed_image">
<span class="sig-name descname"><span class="pre">save_compressed_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.save_compressed_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.save_compressed_image" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Function to save image, including all attributes, in compressed pickle (.pbz2) format. Image will </dt><dd><p>be saved at location <code class="docutils literal notranslate"><span class="pre">filename</span></code>.
Advantage over <a class="reference internal" href="#EELSFitter.core.spectral_image.SpectralImage.save_image" title="EELSFitter.core.spectral_image.SpectralImage.save_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save_image()</span></code></a> is that the saved file has a reduced file size, disadvantage is that saving and reloading the image takes significantly longer.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – path to save location plus filename. If it does not end on “.pbz2”, “.pbz2” will be added.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.save_image">
<span class="sig-name descname"><span class="pre">save_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.save_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.save_image" title="Link to this definition"></a></dt>
<dd><p>Function to save image, including all attributes, in pickle (.pkl) format. Image will be saved at indicated location and name in filename input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – path to save location plus filename. If it does not end on “.pkl”, “.pkl” will be added.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.set_eaxis">
<span class="sig-name descname"><span class="pre">set_eaxis</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.set_eaxis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.set_eaxis" title="Link to this definition"></a></dt>
<dd><p>Determines the energy losses of the spectral image, based on the bin
width of the energy loss. It shifts the <code class="docutils literal notranslate"><span class="pre">self.eaxis</span></code> attribute such
that the zero point corresponds with the point of the highest intensity.</p>
<p>It also set the extrapolated eaxis for calculations that require extrapolation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>eaxis</strong> – Array of <span class="math notranslate nohighlight">\(\Delta E\)</span> values</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a>, shape=(M,)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.set_mass_density">
<span class="sig-name descname"><span class="pre">set_mass_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.set_mass_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.set_mass_density" title="Link to this definition"></a></dt>
<dd><p>Sets value of mass density for the image as attribute self.rho. If not clustered, rho will be an
array of length one, otherwise it is an array of length n_clusters. If rho_background is defined,
the cluster with the lowest thickness (cluster 0) will be assumed to be the vacuum/background,
and gets the value of the background mass density.</p>
<p>If there are more specimen present in the image, it is wise to check by hand what cluster belongs
to what specimen, and set the values by running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">image</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="n">cluster_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_i</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rho</strong></p></li>
<li><p><strong>rho_background</strong></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.set_refractive_index">
<span class="sig-name descname"><span class="pre">set_refractive_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.set_refractive_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.set_refractive_index" title="Link to this definition"></a></dt>
<dd><p>Sets value of refractive index for the image as attribute self.n. If not clustered, n will be an
array of length one, otherwise it is an array of length n_clusters. If n_background is defined,
the cluster with the lowest thickness (cluster 0) will be assumed to be the vacuum/background,
and gets the value of the background refractive index.</p>
<p>If there are more specimen present in the image, it is wise to check by hand what cluster belongs
to what specimen, and set the values by running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">image</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="n">cluster_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_i</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – refractive index of sample.</p></li>
<li><p><strong>n_background</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – if defined: the refractive index of the background/vacuum. This value will automatically be assigned to pixels belonging to the thinnest cluster.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.shape" title="Link to this definition"></a></dt>
<dd><p>Returns 3D-shape of
<a class="reference internal" href="#EELSFitter.core.spectral_image.SpectralImage" title="EELSFitter.core.spectral_image.SpectralImage"><code class="xref py py-meth docutils literal notranslate"><span class="pre">spectral_image.SpectralImage</span></code></a> object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.smooth_signal">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">smooth_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">51</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hanning'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">14.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polyorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.smooth_signal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.smooth_signal" title="Link to this definition"></a></dt>
<dd><p>Smooth a signal using a window length <code class="docutils literal notranslate"><span class="pre">window_length</span></code> and a window type <code class="docutils literal notranslate"><span class="pre">window_type</span></code>.</p>
<p>This method is based on the convolution of a scaled window with the signal.
The signal is prepared by introducing reflected copies of the signal
(with the window size) in both ends so that transient parts are minimized
in the beginning and end part of the output signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a><em>, </em><em>shape=</em><em>(</em><em>M</em><em>,</em><em>)</em>) – Signal of length M</p></li>
<li><p><strong>window_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – The dimension of the smoothing window; should be an odd integer. Default is 51.</p></li>
<li><p><strong>window_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – the type of window from <code class="docutils literal notranslate"><span class="pre">'flat'</span></code>, <code class="docutils literal notranslate"><span class="pre">'hanning'</span></code>, <code class="docutils literal notranslate"><span class="pre">'hamming'</span></code>, <code class="docutils literal notranslate"><span class="pre">'bartlett'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'blackman'</span></code> and <code class="docutils literal notranslate"><span class="pre">'kaiser'</span></code>. <code class="docutils literal notranslate"><span class="pre">'flat'</span></code> window will produce a moving average smoothing.
Default is <code class="docutils literal notranslate"><span class="pre">'hanning'</span></code>.</p></li>
<li><p><strong>beta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – If using the kaiser window, beta determines the shape parameter for window.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>signal_smooth</strong> – The smoothed signal</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a>, shape=(M,)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.subtract_image">
<span class="sig-name descname"><span class="pre">subtract_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'EELS'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.subtract_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.subtract_image" title="Link to this definition"></a></dt>
<dd><p>Subtract the ZLP from the signals of all pixels. Only the median value of the ZLP models is taken.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kwargs</strong></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.subtract_zlp">
<span class="sig-name descname"><span class="pre">subtract_zlp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zlp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.subtract_zlp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.subtract_zlp" title="Link to this definition"></a></dt>
<dd><p>Subtract the Zero Loss Peak from the signal</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a><em>, </em><em>shape=</em><em>(</em><em>M</em><em>,</em><em>)</em>) – Raw signal of length M</p></li>
<li><p><strong>zlp</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a><em>, </em><em>shape=</em><em>(</em><em>M</em><em>,</em><em>)</em>) – zero-loss peak of length M</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.spectral_image.SpectralImage.train_zlp_models">
<span class="sig-name descname"><span class="pre">train_zlp_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conf_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'EELS'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/spectral_image.html#SpectralImage.train_zlp_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.spectral_image.SpectralImage.train_zlp_models" title="Link to this definition"></a></dt>
<dd><p>Train the ZLP on the spectral image.</p>
<p>The spectral image is clustered in <code class="docutils literal notranslate"><span class="pre">n_clusters</span></code> clusters, according to
e.g. the integrated intensity or thickness. A random spectrum is then
taken from each cluster, which together defines one replica. The
training is initiated by calling
<code class="xref py py-meth docutils literal notranslate"><span class="pre">train_zlp_models_scaled()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>conf_interval</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Default is 1</p></li>
<li><p><strong>lr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Default is 1</p></li>
<li><p><strong>signal_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Type of spectrum. Set to EELS by default.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments that are passed to the method
<code class="xref py py-meth docutils literal notranslate"><span class="pre">train_zlp_models_scaled()</span></code>
in the <code class="xref py py-mod docutils literal notranslate"><span class="pre">training</span></code> module.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-EELSFitter.core.training">
<span id="eelsfitter-core-training-module"></span><h2>EELSFitter.core.training module<a class="headerlink" href="#module-EELSFitter.core.training" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="EELSFitter.core.training.MultilayerPerceptron">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">EELSFitter.core.training.</span></span><span class="sig-name descname"><span class="pre">MultilayerPerceptron</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_outputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#MultilayerPerceptron"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.MultilayerPerceptron" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>Multilayer Perceptron (MLP) class. It uses the following architecture</p>
<div class="math notranslate nohighlight">
\[[n_i, 10, 15, 5, n_f],\]</div>
<p>where <span class="math notranslate nohighlight">\(n_i\)</span> and <span class="math notranslate nohighlight">\(n_f\)</span> denote the number of input features and
output target values respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of input features</p></li>
<li><p><strong>num_outputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – dimension of the target output.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.training.MultilayerPerceptron.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#MultilayerPerceptron.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.MultilayerPerceptron.forward" title="Link to this definition"></a></dt>
<dd><p>Propagates the input features <code class="docutils literal notranslate"><span class="pre">x</span></code> through the MLP.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.tensor</em>) – input features</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>x</strong> – MLP outcome</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="EELSFitter.core.training.TrainZeroLossPeak">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">EELSFitter.core.training.</span></span><span class="sig-name descname"><span class="pre">TrainZeroLossPeak</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spectra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eaxis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_centroids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_report_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_batch_of_replica</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_batches</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_replica</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_de1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_de2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regularisation_constant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_to_models</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./models/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_temp_files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#TrainZeroLossPeak"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.TrainZeroLossPeak" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.training.TrainZeroLossPeak.calc_scale_var_log_int_i">
<span class="sig-name descname"><span class="pre">calc_scale_var_log_int_i</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">based_on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'log_zlp'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#TrainZeroLossPeak.calc_scale_var_log_int_i"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.TrainZeroLossPeak.calc_scale_var_log_int_i" title="Link to this definition"></a></dt>
<dd><p>Calculate the scale variables of the log of the integrated intensity of the spectra for the three highest bins
of the Zero Loss Peak.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.training.TrainZeroLossPeak.calculate_hyperparameters">
<span class="sig-name descname"><span class="pre">calculate_hyperparameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#TrainZeroLossPeak.calculate_hyperparameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.TrainZeroLossPeak.calculate_hyperparameters" title="Link to this definition"></a></dt>
<dd><p>Calculate the values of the hyperparameters in the gain and loss region, dE1 and mdE1 are calculated by taking
the location of the kneedles at each side of the ZLP and shifting them with the gives shift value.</p>
<p>dE2 and mdE2 are calcualted by taking the value of the eaxis where a fit of the log10 function intersects with
a single count. If this value is not found the end point of the signal is taken as location for dE2.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.training.TrainZeroLossPeak.cleanup_files">
<span class="sig-name descname"><span class="pre">cleanup_files</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#TrainZeroLossPeak.cleanup_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.TrainZeroLossPeak.cleanup_files" title="Link to this definition"></a></dt>
<dd><p>Cleans up the files generated by train_zlp_models_scaled.
costs_train_*, costs_test_*, and nn_rep_* files are merged into single files
costs_train, costs_test, and nn_parameters respectively.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.training.TrainZeroLossPeak.find_difflog_local_minmax_idx">
<span class="sig-name descname"><span class="pre">find_difflog_local_minmax_idx</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#TrainZeroLossPeak.find_difflog_local_minmax_idx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.TrainZeroLossPeak.find_difflog_local_minmax_idx" title="Link to this definition"></a></dt>
<dd><p>Determine the local minimum and maximum of the differential of the log of the signals per cluster</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.training.TrainZeroLossPeak.find_fwhm_idx">
<span class="sig-name descname"><span class="pre">find_fwhm_idx</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#TrainZeroLossPeak.find_fwhm_idx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.TrainZeroLossPeak.find_fwhm_idx" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Determine the FWHM indices per cluster (Full Width at Half Maximum):</dt><dd><ul class="simple">
<li><p>indices of the left and right side of the ZLP</p></li>
<li><p>indices of the left and right side of the log of the ZLP</p></li>
</ul>
</dd>
</dl>
<p>These are all determine by taking the local minimum and maximum of the dy/dx</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.training.TrainZeroLossPeak.find_kneedle_idx">
<span class="sig-name descname"><span class="pre">find_kneedle_idx</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#TrainZeroLossPeak.find_kneedle_idx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.TrainZeroLossPeak.find_kneedle_idx" title="Link to this definition"></a></dt>
<dd><p>Find the kneedle index per cluster.
The kneedle algorithm is used to find the point of highest curvature in your concave or convex data set.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.training.TrainZeroLossPeak.find_local_min_idx">
<span class="sig-name descname"><span class="pre">find_local_min_idx</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#TrainZeroLossPeak.find_local_min_idx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.TrainZeroLossPeak.find_local_min_idx" title="Link to this definition"></a></dt>
<dd><p>Determine the first local minimum index of the signals per cluster by setting it to the point where the
derivative crosses zero.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.training.TrainZeroLossPeak.initialize_x_y_sigma_input">
<span class="sig-name descname"><span class="pre">initialize_x_y_sigma_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cluster_label</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#TrainZeroLossPeak.initialize_x_y_sigma_input"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.TrainZeroLossPeak.initialize_x_y_sigma_input" title="Link to this definition"></a></dt>
<dd><p>Initialize the x, y and sigma input for the Neural Network. The spectrum is split into the
3 regions as given by the toy model. For the y data, the data in region I is set to the log intensity
up to dE1, the data in region III is set to zero. For the x data two input features, first is the values
of the energy axis in region I and III, second is the rescaled log of the total integrated intensity.
This factor is to ensure symmetry is retained between input and output values. For the sigma data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cluster_label</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Label of the cluster</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.training.TrainZeroLossPeak.loss_function">
<span class="sig-name descname"><span class="pre">loss_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_for_derivative</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#TrainZeroLossPeak.loss_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.TrainZeroLossPeak.loss_function" title="Link to this definition"></a></dt>
<dd><p>The loss function to train the ZLP takes the model <code class="docutils literal notranslate"><span class="pre">output</span></code>, the raw  spectrum <code class="docutils literal notranslate"><span class="pre">target</span></code> and the associated
<code class="docutils literal notranslate"><span class="pre">error</span></code>. The latter corresponds to  the one sigma spread within a given cluster at fixed <span class="math notranslate nohighlight">\(\Delta E\)</span>.
It returns the cost function <span class="math notranslate nohighlight">\(C_{\mathrm{ZLP}}^{(m)}\)</span> associated with the replica <span class="math notranslate nohighlight">\(m\)</span> as</p>
<div class="math notranslate nohighlight" id="equation-eq-lossfunction">
<span class="eqno">(38)<a class="headerlink" href="#equation-eq-lossfunction" title="Link to this equation"></a></span>\[C_{\mathrm{ZLP}}^{(m)} = \frac{1}{n_{E}} \sum_{k=1}^K \sum_{\ell_k=1}^{n_E^{(k)}} \frac{\left[I^{(i_{m,k}, j_{m,k})}(E_{\ell_k}) - I_{\rm ZLP}^{({\mathrm{NN}})(m)} \left(E_{\ell_k},\ln \left( N_{\mathrm{ tot}}^{(i_{m,k},j_{m,k})} \right) \right) \right]^2}{\sigma^2_k \left(E_{\ell_k} \right)}.\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eaxis</strong> (<em>np.ndarray</em>) – Energy-loss axis</p></li>
<li><p><strong>output</strong> (<em>torch.tensor</em>) – Neural Network output</p></li>
<li><p><strong>output_for_derivative</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><em>torch.tensor</em>) – Each entry in the list should correspond to the neural
network output between de1 and de2 of a single spectrum
in the replica</p></li>
<li><p><strong>target</strong> (<em>torch.tensor</em>) – Raw EELS spectrum</p></li>
<li><p><strong>error</strong> (<em>torch.tensor</em>) – Uncertainty on <span class="math notranslate nohighlight">\(\log I_{\mathrm{EELS}}(\Delta E)\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>loss</strong> – Loss associated with the model <code class="docutils literal notranslate"><span class="pre">output</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.training.TrainZeroLossPeak.plot_hp_cluster">
<span class="sig-name descname"><span class="pre">plot_hp_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#TrainZeroLossPeak.plot_hp_cluster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.TrainZeroLossPeak.plot_hp_cluster" title="Link to this definition"></a></dt>
<dd><p>Create a plot of the hyperparameters plotted on top of the spectra per cluster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – Additional keyword arguments.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.training.TrainZeroLossPeak.plot_hp_cluster_slope">
<span class="sig-name descname"><span class="pre">plot_hp_cluster_slope</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#TrainZeroLossPeak.plot_hp_cluster_slope"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.TrainZeroLossPeak.plot_hp_cluster_slope" title="Link to this definition"></a></dt>
<dd><p>Create a plot of the hyperparameters plotted on top of the slopes of the spectra per cluster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – Additional keyword arguments.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.training.TrainZeroLossPeak.plot_training_report">
<span class="sig-name descname"><span class="pre">plot_training_report</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#TrainZeroLossPeak.plot_training_report"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.TrainZeroLossPeak.plot_training_report" title="Link to this definition"></a></dt>
<dd><p>Creat the training report plot: evolution of the training and validation
loss per epoch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.training.TrainZeroLossPeak.save_figplot">
<span class="sig-name descname"><span class="pre">save_figplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'no_title.pdf'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#TrainZeroLossPeak.save_figplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.TrainZeroLossPeak.save_figplot" title="Link to this definition"></a></dt>
<dd><p>Display the computed values of dE1 (both methods) together with the
raw EELS spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<em>matplotlib.Figure</em>) – Figure to be saved.</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Filename to store the plot in.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.training.TrainZeroLossPeak.save_hyperparameters">
<span class="sig-name descname"><span class="pre">save_hyperparameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#TrainZeroLossPeak.save_hyperparameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.TrainZeroLossPeak.save_hyperparameters" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Save the hyperparameters in hyperparameters.txt. These are:</dt><dd><ul class="simple">
<li><p>cluster centroids, keep note if they were determined from the raw data, or if the log had been taken.</p></li>
<li><p>dE1 for all clusters</p></li>
<li><p>dE2 for all clusters</p></li>
<li><p>FWHM for all clusters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.training.TrainZeroLossPeak.save_scale_var_log_int_i">
<span class="sig-name descname"><span class="pre">save_scale_var_log_int_i</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#TrainZeroLossPeak.save_scale_var_log_int_i"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.TrainZeroLossPeak.save_scale_var_log_int_i" title="Link to this definition"></a></dt>
<dd><p>Save the scale variables of the log of the total integrated intensity of the spectra, denoted <code class="docutils literal notranslate"><span class="pre">I</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.training.TrainZeroLossPeak.scale_eaxis">
<span class="sig-name descname"><span class="pre">scale_eaxis</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#TrainZeroLossPeak.scale_eaxis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.TrainZeroLossPeak.scale_eaxis" title="Link to this definition"></a></dt>
<dd><p>Scales the features of the energy axis between [0.1, 0.9]. This is to optimize the speed
of the neural network.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.training.TrainZeroLossPeak.set_dydx_data">
<span class="sig-name descname"><span class="pre">set_dydx_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#TrainZeroLossPeak.set_dydx_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.TrainZeroLossPeak.set_dydx_data" title="Link to this definition"></a></dt>
<dd><p>Determines the slope of all spectra per cluster, smooths the slope and takes the median per cluster.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.training.TrainZeroLossPeak.set_minimum_intensities">
<span class="sig-name descname"><span class="pre">set_minimum_intensities</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#TrainZeroLossPeak.set_minimum_intensities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.TrainZeroLossPeak.set_minimum_intensities" title="Link to this definition"></a></dt>
<dd><p>Set all features smaller than 1 to 1.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.training.TrainZeroLossPeak.set_path_for_training_report">
<span class="sig-name descname"><span class="pre">set_path_for_training_report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">j</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#TrainZeroLossPeak.set_path_for_training_report"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.TrainZeroLossPeak.set_path_for_training_report" title="Link to this definition"></a></dt>
<dd><p>Set the save directory for the training report of the replica being trained on.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>j</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Index of the replica being trained on.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.training.TrainZeroLossPeak.set_sigma">
<span class="sig-name descname"><span class="pre">set_sigma</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#TrainZeroLossPeak.set_sigma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.TrainZeroLossPeak.set_sigma" title="Link to this definition"></a></dt>
<dd><p>Determine the sigma (spread of spectra per cluster) per cluster.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.training.TrainZeroLossPeak.set_test_x_y_sigma">
<span class="sig-name descname"><span class="pre">set_test_x_y_sigma</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#TrainZeroLossPeak.set_test_x_y_sigma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.TrainZeroLossPeak.set_test_x_y_sigma" title="Link to this definition"></a></dt>
<dd><p>Take the x, y and sigma data for the test set and reshape them for neural network input</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.training.TrainZeroLossPeak.set_train_x_y_sigma">
<span class="sig-name descname"><span class="pre">set_train_x_y_sigma</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#TrainZeroLossPeak.set_train_x_y_sigma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.TrainZeroLossPeak.set_train_x_y_sigma" title="Link to this definition"></a></dt>
<dd><p>Take the x, y and sigma data for the train set and reshape them for neural network input</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.training.TrainZeroLossPeak.set_y_data">
<span class="sig-name descname"><span class="pre">set_y_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#TrainZeroLossPeak.set_y_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.TrainZeroLossPeak.set_y_data" title="Link to this definition"></a></dt>
<dd><p>Smooths all the spectra per cluster and takes the median per cluster.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.training.TrainZeroLossPeak.train_and_evaluate_model">
<span class="sig-name descname"><span class="pre">train_and_evaluate_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#TrainZeroLossPeak.train_and_evaluate_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.TrainZeroLossPeak.train_and_evaluate_model" title="Link to this definition"></a></dt>
<dd><p>Train and evaluate the model. Also saves the values of cost_train and cost_test per epoch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>j</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>lr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – learning rate</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.training.TrainZeroLossPeak.train_zlp_models_scaled">
<span class="sig-name descname"><span class="pre">train_zlp_models_scaled</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#TrainZeroLossPeak.train_zlp_models_scaled"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.TrainZeroLossPeak.train_zlp_models_scaled" title="Link to this definition"></a></dt>
<dd><p>Train the ZLP models. This functions calls up the other functions step by step to complete the whole process.
Refer to each function for details what they specifically perform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>lr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>,</em>) – Learning rate of the neural network</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.training.TrainZeroLossPeak.write_txt_of_loss">
<span class="sig-name descname"><span class="pre">write_txt_of_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#TrainZeroLossPeak.write_txt_of_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.TrainZeroLossPeak.write_txt_of_loss" title="Link to this definition"></a></dt>
<dd><p>Write train/test loss to a .txt file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Directory to store the report in.</p></li>
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Filename of .txt file to store report in.</p></li>
<li><p><strong>loss</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List containing loss value per epoch.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="EELSFitter.core.training.find_scale_var">
<span class="sig-prename descclassname"><span class="pre">EELSFitter.core.training.</span></span><span class="sig-name descname"><span class="pre">find_scale_var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#find_scale_var"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.find_scale_var" title="Link to this definition"></a></dt>
<dd><p>Computes the scaling parameters needed to rescale the training data to lie
between <code class="docutils literal notranslate"><span class="pre">min_out</span></code> and <code class="docutils literal notranslate"><span class="pre">max_out</span></code>. For our neural network the value range [0.1, 0.9] ensures the
neuron activation states will typically lie close to the linear region of the sigmoid activation function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inp</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a><em>, </em><em>shape=</em><em>(</em><em>M</em><em>,</em><em>)</em>) – training data to be rescaled</p></li>
<li><p><strong>min_out</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – lower limit. Set to 0.1 by default.</p></li>
<li><p><strong>max_out</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – upper limit. Set to 0.9 by default</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>a, b</strong> – list of rescaling parameters</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="EELSFitter.core.training.log10_fit">
<span class="sig-prename descclassname"><span class="pre">EELSFitter.core.training.</span></span><span class="sig-name descname"><span class="pre">log10_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#log10_fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.log10_fit" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="EELSFitter.core.training.power_fit">
<span class="sig-prename descclassname"><span class="pre">EELSFitter.core.training.</span></span><span class="sig-name descname"><span class="pre">power_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#power_fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.power_fit" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="EELSFitter.core.training.scale">
<span class="sig-prename descclassname"><span class="pre">EELSFitter.core.training.</span></span><span class="sig-name descname"><span class="pre">scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ab</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#scale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.scale" title="Link to this definition"></a></dt>
<dd><p>Rescale the training data to lie between 0.1 and 0.9. Rescaling features is to help speed up the neural network
training process. The value range [0.1, 0.9] ensures the neuron activation states will typically lie close to the
linear region of the sigmoid activation function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inp</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a><em>, </em><em>shape=</em><em>(</em><em>M</em><em>,</em><em>)</em>) – training data to be rescaled, e.g. <span class="math notranslate nohighlight">\(\Delta E\)</span></p></li>
<li><p><strong>ab</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a><em>, </em><em>shape=</em><em>(</em><em>M</em><em>,</em><em>)</em>) – scaling parameters, which can be found with
<a class="reference internal" href="#EELSFitter.core.training.find_scale_var" title="EELSFitter.core.training.find_scale_var"><code class="xref py py-meth docutils literal notranslate"><span class="pre">find_scale_var()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Rescaled training data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="EELSFitter.core.training.smooth_signal">
<span class="sig-prename descclassname"><span class="pre">EELSFitter.core.training.</span></span><span class="sig-name descname"><span class="pre">smooth_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">51</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hanning'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">14.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#smooth_signal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.smooth_signal" title="Link to this definition"></a></dt>
<dd><p>Smooth a signal using a window length <code class="docutils literal notranslate"><span class="pre">window_length</span></code> and a window type <code class="docutils literal notranslate"><span class="pre">window_type</span></code>.</p>
<p>This method is based on the convolution of a scaled window with the signal.
The signal is prepared by introducing reflected copies of the signal
(with the window size) in both ends so that transient parts are minimized
in the beginning and end part of the output signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a><em>, </em><em>shape=</em><em>(</em><em>M</em><em>,</em><em>)</em>) – Signal of length M</p></li>
<li><p><strong>window_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – The dimension of the smoothing window; should be an odd integer. Default is 51.</p></li>
<li><p><strong>window_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – the type of window from <code class="docutils literal notranslate"><span class="pre">'flat'</span></code>, <code class="docutils literal notranslate"><span class="pre">'hanning'</span></code>, <code class="docutils literal notranslate"><span class="pre">'hamming'</span></code>, <code class="docutils literal notranslate"><span class="pre">'bartlett'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'blackman'</span></code> and <code class="docutils literal notranslate"><span class="pre">'kaiser'</span></code>. <code class="docutils literal notranslate"><span class="pre">'flat'</span></code> window will produce a moving average smoothing.
Default is <code class="docutils literal notranslate"><span class="pre">'hanning'</span></code></p></li>
<li><p><strong>beta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – If using the kaiser window, beta determines the shape parameter for window.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>signal_smooth</strong> – The smoothed signal</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a>, shape=(M,)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="EELSFitter.core.training.smooth_signals_per_cluster">
<span class="sig-prename descclassname"><span class="pre">EELSFitter.core.training.</span></span><span class="sig-name descname"><span class="pre">smooth_signals_per_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">51</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hanning'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#smooth_signals_per_cluster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.smooth_signals_per_cluster" title="Link to this definition"></a></dt>
<dd><p>Smooth all signals in a cluster using a window length <code class="docutils literal notranslate"><span class="pre">window_len</span></code> and a window type <code class="docutils literal notranslate"><span class="pre">window</span></code>.</p>
<p>This method is based on the convolution of a scaled window with the signal.
The signal is prepared by introducing reflected copies of the signal
(with the window size) in both ends so that transient parts are minimized
in the beginning and end part of the output signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signals</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a><em>, </em><em>shape=</em><em>(</em><em>M</em><em>,</em><em>)</em>) – The input data</p></li>
<li><p><strong>window_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – The dimension of the smoothing window; should be an odd integer. Default is 51</p></li>
<li><p><strong>window_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – the type of window from <code class="docutils literal notranslate"><span class="pre">&quot;flat&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;hanning&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;hamming&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;bartlett&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;blackman&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;kasier&quot;</span></code>. <code class="docutils literal notranslate"><span class="pre">&quot;flat&quot;</span></code> window will produce a moving average smoothing.
Default is <code class="docutils literal notranslate"><span class="pre">&quot;hanning&quot;</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>signal_smooth</strong> – The smoothed signal</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a>, shape=(M,)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="EELSFitter.core.training.weight_reset">
<span class="sig-prename descclassname"><span class="pre">EELSFitter.core.training.</span></span><span class="sig-name descname"><span class="pre">weight_reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/training.html#weight_reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.training.weight_reset" title="Link to this definition"></a></dt>
<dd><p>Reset the weights and biases associated with the model <code class="docutils literal notranslate"><span class="pre">m</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>m</strong> (<em>MLP</em>) – Model of type <code class="xref py py-meth docutils literal notranslate"><span class="pre">MLP</span></code>.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-EELSFitter.core.gainpeakfitter">
<span id="eelsfitter-core-gainpeakfitter-module"></span><h2>EELSFitter.core.gainpeakfitter module<a class="headerlink" href="#module-EELSFitter.core.gainpeakfitter" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="EELSFitter.core.gainpeakfitter.GainPeakFitter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">EELSFitter.core.gainpeakfitter.</span></span><span class="sig-name descname"><span class="pre">GainPeakFitter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/gainpeakfitter.html#GainPeakFitter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.gainpeakfitter.GainPeakFitter" title="Link to this definition"></a></dt>
<dd><p>This class extracts gain peaks from an EEL spectrum. The GainPeakFitter
fits the ZLP to a Gaussian based on the ZLP’s FWHM. The ZLP is then
subtractred from the EEL spectrum (also referred to as ‘the signal’). The
subtracted signal contains a peak which is then fitted to a Lorentzian.
From the Lorentzian, the energy of the gain peak is determined.</p>
<section id="input">
<h3>INPUT<a class="headerlink" href="#input" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>image<span class="classifier">spectral image</span></dt><dd><p>4D data from a .dm4 file</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>To fit the gain/loss peaks:</p>
<blockquote>
<div><p>lrtz = GainPeakFitter(x_signal, y_signal, image_shape)</p>
<p>lrtz.generate_best_fits()</p>
<p>lrtz.fit_gain_peak()</p>
<p>lrtz.fit_loss_peak()</p>
</div></blockquote>
<p>To plot the gain/loss peaks:</p>
<blockquote>
<div><p>lrtz.create_new_plot()</p>
<p>lrtz.plot_all_results()</p>
<p>lrtz.ax.set_ylim(0, 1e4)</p>
<p>lrtz.fig</p>
<p>lrtz.plot_signal()</p>
<p>lrtz.plot_model()</p>
<p>lrtz.plot_subtracted()</p>
<p>lrtz.plot_gain_peak()</p>
<p>lrtz.plot_loss_peak()</p>
<p>lrtz.print_results()</p>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.gainpeakfitter.GainPeakFitter.array2D_of_intensity_at_energy_loss">
<span class="sig-name descname"><span class="pre">array2D_of_intensity_at_energy_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eloss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/gainpeakfitter.html#GainPeakFitter.array2D_of_intensity_at_energy_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.gainpeakfitter.GainPeakFitter.array2D_of_intensity_at_energy_loss" title="Link to this definition"></a></dt>
<dd><p>Generate 2D array of intensities for each SI-pixel at a chosen energy
loss.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.gainpeakfitter.GainPeakFitter.create_new_plot">
<span class="sig-name descname"><span class="pre">create_new_plot</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/gainpeakfitter.html#GainPeakFitter.create_new_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.gainpeakfitter.GainPeakFitter.create_new_plot" title="Link to this definition"></a></dt>
<dd><p>Create pyplot.subplots figure with axes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.gainpeakfitter.GainPeakFitter.curve_fit_between">
<span class="sig-name descname"><span class="pre">curve_fit_between</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_right</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.6</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/gainpeakfitter.html#GainPeakFitter.curve_fit_between"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.gainpeakfitter.GainPeakFitter.curve_fit_between" title="Link to this definition"></a></dt>
<dd><p>Curve fit between chosen eloss fitting range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.array</em>) – eloss [in eV]</p></li>
<li><p><strong>y</strong> (<em>np.array</em>) – signal, intensity, electron count [in a.u.]</p></li>
<li><p><strong>x_left</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – left margin of eloss fitting range</p></li>
<li><p><strong>x_right</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – right margin of eloss fitting range</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.gainpeakfitter.GainPeakFitter.curve_fit_between_background">
<span class="sig-name descname"><span class="pre">curve_fit_between_background</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_right</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.6</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/gainpeakfitter.html#GainPeakFitter.curve_fit_between_background"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.gainpeakfitter.GainPeakFitter.curve_fit_between_background" title="Link to this definition"></a></dt>
<dd><p>Curve fit between chosen eloss fitting range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.array</em>) – eloss [in eV]</p></li>
<li><p><strong>y</strong> (<em>np.array</em>) – signal, intensity, electron count [in a.u.]</p></li>
<li><p><strong>x_left</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – left margin of eloss fitting range</p></li>
<li><p><strong>x_right</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – right margin of eloss fitting range</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.gainpeakfitter.GainPeakFitter.determine_parameters">
<span class="sig-name descname"><span class="pre">determine_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/gainpeakfitter.html#GainPeakFitter.determine_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.gainpeakfitter.GainPeakFitter.determine_parameters" title="Link to this definition"></a></dt>
<dd><p>Determines the parameters specifying a Gaussian or Lorentzian function using
the signal’s peak height and the FWHM of the peak.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>function</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>{'Gaussian'</em><em>, </em><em>'Lorentzian'}</em>) – Model choice for the ZLP.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.gainpeakfitter.GainPeakFitter.fit_gain_peak_mc">
<span class="sig-name descname"><span class="pre">fit_gain_peak_mc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-3.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_conf_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/gainpeakfitter.html#GainPeakFitter.fit_gain_peak_mc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.gainpeakfitter.GainPeakFitter.fit_gain_peak_mc" title="Link to this definition"></a></dt>
<dd><p>Use the Monte Carlo replica method to fit a Lorentzian model to the subtracted spectrum
in a specified energy interval [<code class="docutils literal notranslate"><span class="pre">L_bound,</span> <span class="pre">R_bound</span></code>].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – y-coordinate of the pixel.</p></li>
<li><p><strong>j</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – x-coordinate of the pixel.</p></li>
<li><p><strong>L_bound</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Left bound of the interval in which to fit to the subtracted spectrum.</p></li>
<li><p><strong>R_bound</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Right bound of the interval in which to fit to the subtracted spectrum.</p></li>
<li><p><strong>return_all</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Option to return the subtracted spectra for all replicas corresponding
to this pixel.</p></li>
<li><p><strong>return_conf_interval</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Option to specify if the upper and lower bounds of the confidence
interval must be returned.</p></li>
<li><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>gain</strong> (<em>numpy.ndarray</em>) – Array with the median Lorentzian fit to the subtracted spectrum.</p></li>
<li><p><strong>gain_low</strong> (<em>numpy.ndarray, optional</em>) – Lower bound of the Lorentzian fit.</p></li>
<li><p><strong>gain_high</strong> (<em>numpy.ndarray, optional</em>) – Upper bound of the Lorentzian fit.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.gainpeakfitter.GainPeakFitter.fit_models">
<span class="sig-name descname"><span class="pre">fit_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_rep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_clusters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'EELS'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/gainpeakfitter.html#GainPeakFitter.fit_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.gainpeakfitter.GainPeakFitter.fit_models" title="Link to this definition"></a></dt>
<dd><p>Use the Monte Carlo replica method to fit chosen <code class="docutils literal notranslate"><span class="pre">function</span></code> model to the ZLP. In this method
it is assumed that in each cluster the ZLP is sampled from the same underlying distribution in that
particular cluster. This methods samples the underlying distribution in order to obtain the median,
low, and high predictions for the ZLP at teach loss value.</p>
<p>The model predictions are stored in self.zlp_models_all, where the median, low, and high values are the first,
second, and third element respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_rep</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default=500</em>) – Number of Monte Carlo replicas to use.</p></li>
<li><p><strong>n_clusters</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default=5</em>) – Number of clusters to use.</p></li>
<li><p><strong>function</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>{'Gaussian'</em><em>, </em><em>'Split Gausian'</em><em>, </em><em>'Lorentzian'</em><em>, </em><em>'Pearson VII'</em><em>, </em><em>'Split Pearson VII'</em><em>, </em><em>'Pseudo-Voigt'</em><em>, </em><em>'Split Pseudo-Voigt'</em><em>, </em><em>'Generalised Peak'</em><em>, </em><em>'Kaiser window'}</em>) – Model choice for the ZLP.</p></li>
<li><p><strong>conf_interval</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – The ratio of spectra returned. The spectra are selected based on the
based_on value. The default is 1.</p></li>
<li><p><strong>signal_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Description of signal, <code class="docutils literal notranslate"><span class="pre">'EELS'</span></code> by default.</p></li>
<li><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – Additional keyword arguments.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.gainpeakfitter.GainPeakFitter.fwhm">
<span class="sig-name descname"><span class="pre">fwhm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/gainpeakfitter.html#GainPeakFitter.fwhm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.gainpeakfitter.GainPeakFitter.fwhm" title="Link to this definition"></a></dt>
<dd><p>Calculates the FWHM of the ZLP in a particular pixel (<code class="docutils literal notranslate"><span class="pre">row</span></code>, <code class="docutils literal notranslate"><span class="pre">col</span></code> ). Optionally
calculate FWHM through fitting a Gaussian to the ZLP and extracting the FWHM.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>do_fit</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default=True</em>) – Option to obtain FWHM through fitting a Gaussian.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fwhm</strong> (<em>float</em>) – FWHM of the ZLP in chosen pixel.</p></li>
<li><p><strong>fit</strong> (<em>float</em>) – FWHM obtained through fitting a Gaussian to the ZLP.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.gainpeakfitter.GainPeakFitter.gaussian">
<span class="sig-name descname"><span class="pre">gaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/gainpeakfitter.html#GainPeakFitter.gaussian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.gainpeakfitter.GainPeakFitter.gaussian" title="Link to this definition"></a></dt>
<dd><p>Gaussian centered around <code class="docutils literal notranslate"><span class="pre">x</span></code> = <code class="docutils literal notranslate"><span class="pre">x0</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.ndrray</em>) – 1D array of the energy loss.</p></li>
<li><p><strong>x0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Energy loss at the center of the Gaussian.</p></li>
<li><p><strong>a</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Height of the Gaussian peak.</p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Standard deviation of the Gaussian.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Gaussian.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.gainpeakfitter.GainPeakFitter.generalised_peak">
<span class="sig-name descname"><span class="pre">generalised_peak</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/gainpeakfitter.html#GainPeakFitter.generalised_peak"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.gainpeakfitter.GainPeakFitter.generalised_peak" title="Link to this definition"></a></dt>
<dd><p>Generalised Peak function calculated as</p>
<div class="math notranslate nohighlight">
\[\frac{2}{\pi \delta} \Bigg|\frac{\Gamma\left[\frac{\nu}{2} + i \gamma_\nu \left(\frac{4 x_s^2}{\pi^2 \delta^2} \right)^2 \right]}{\Gamma\left[\frac{\nu}{2}] \right]}\Bigg|^2,\]</div>
<p>where <span class="math notranslate nohighlight">\(\gamma_\nu = \sqrt{\pi} \frac{\Gamma\left[\frac{\nu + 1}{2} \right]}{\Gamma\left[\nu + \frac{1}{2} \right]}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – 1D array of energy loss.</p></li>
<li><p><strong>x_0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Energy offset.</p></li>
<li><p><strong>delta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Parameter describing the peak width.</p></li>
<li><p><strong>nu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Parameter describing the peak shape.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Generalised Peak function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.gainpeakfitter.GainPeakFitter.get_model">
<span class="sig-name descname"><span class="pre">get_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'EELS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_conf_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/gainpeakfitter.html#GainPeakFitter.get_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.gainpeakfitter.GainPeakFitter.get_model" title="Link to this definition"></a></dt>
<dd><p>Retrieves the model fit to the ZLP at pixel (<code class="docutils literal notranslate"><span class="pre">i</span></code>, <code class="docutils literal notranslate"><span class="pre">j</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – y-coordinate of the pixel.</p></li>
<li><p><strong>j</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – x-coordinate of the pixel.</p></li>
<li><p><strong>signal_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – The type of signal that is requested, should comply with the defined
names. Set to <code class="docutils literal notranslate"><span class="pre">'EELS'</span></code> by default.</p></li>
<li><p><strong>return_all</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Option to return all models.</p></li>
<li><p><strong>return_conf_interval</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Option to specify if the upper and lower bounds of the confidence
interval must be returned.</p></li>
<li><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>model</strong> (<em>numpy.ndarray</em>) – Array with the median model fit to the ZLP from the requested pixel.</p></li>
<li><p><strong>model_low</strong> (<em>numpy.ndarray, optional</em>) – Lower bound of the confidence interval of the model fit to the ZLP.</p></li>
<li><p><strong>model_high</strong> (<em>numpy.ndarray, optional</em>) – Upper bound of the confidence interval of the model fit to the ZLP.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.gainpeakfitter.GainPeakFitter.get_subtracted_spectrum">
<span class="sig-name descname"><span class="pre">get_subtracted_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'EELS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_conf_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/gainpeakfitter.html#GainPeakFitter.get_subtracted_spectrum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.gainpeakfitter.GainPeakFitter.get_subtracted_spectrum" title="Link to this definition"></a></dt>
<dd><p>Retrieves the subtracted spectrum at pixel (<code class="docutils literal notranslate"><span class="pre">i</span></code>, <code class="docutils literal notranslate"><span class="pre">j</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – y-coordinate of the pixel.</p></li>
<li><p><strong>j</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – x-coordinate of the pixel.</p></li>
<li><p><strong>signal_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – The type of signal that is requested, should comply with the defined
names. Set to <code class="docutils literal notranslate"><span class="pre">'EELS'</span></code> by default.</p></li>
<li><p><strong>return_all</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Option to return the subtracted spectra for all replicas corresponding
to this pixel.</p></li>
<li><p><strong>return_conf_interval</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Option to specify if the upper and lower bounds of the confidence
interval must be returned.</p></li>
<li><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>signal</strong> (<em>numpy.ndarray</em>) – Array with the median subtracted spectrum from the requested pixel.</p></li>
<li><p><strong>signal_low</strong> (<em>numpy.ndarray, optional</em>) – Lower bound of the confidence interval of the subtracted spectrum.</p></li>
<li><p><strong>signal_high</strong> (<em>numpy.ndarray, optional</em>) – Upper bound of the confidence interval of the subtracted spectrum.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.gainpeakfitter.GainPeakFitter.inspect_spectrum">
<span class="sig-name descname"><span class="pre">inspect_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fit'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/gainpeakfitter.html#GainPeakFitter.inspect_spectrum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.gainpeakfitter.GainPeakFitter.inspect_spectrum" title="Link to this definition"></a></dt>
<dd><p>Fit chosen <code class="docutils literal notranslate"><span class="pre">function</span></code> model to the ZLP and obtain subtracted spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>{'Gaussian'</em><em>, </em><em>'Split Gausian'</em><em>, </em><em>'Lorentzian'</em><em>, </em><em>'Pearson VII'</em><em>, </em><em>'Split Pearson VII'</em><em>, </em><em>'Pseudo-Voigt'</em><em>, </em><em>'Split Pseudo-Voigt'</em><em>, </em><em>'Generalised Peak'</em><em>, </em><em>'Kaiser window'}</em>) – Model choice for the ZLP.</p></li>
<li><p><strong>method</strong> (str, {<code class="docutils literal notranslate"><span class="pre">'fit'</span></code>, <code class="docutils literal notranslate"><span class="pre">'FWHM'</span></code>}) – Method to use to extract model fit parameters. <code class="docutils literal notranslate"><span class="pre">'FWHM'</span></code> is only supported for Gaussian and
Lorentzian ZLP models.</p></li>
<li><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – Additional keyword arguments.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.gainpeakfitter.GainPeakFitter.kaiser">
<span class="sig-name descname"><span class="pre">kaiser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/gainpeakfitter.html#GainPeakFitter.kaiser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.gainpeakfitter.GainPeakFitter.kaiser" title="Link to this definition"></a></dt>
<dd><p>Kaiser window function, calculated as</p>
<div class="math notranslate nohighlight">
\[\begin{split}w_0(x) \triangleq \begin{array}{cl} \frac{1}{L} \frac{I_0\left[m \sqrt{1-(2 x / L)^2}\right]}{I_0[m]},
&amp; |x| \leq L / 2 \\ 0, &amp; |x|&gt;L / 2 \end{array},\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(I_0\)</span> is the zeroth-order modified Bessel function of the first kind.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – 1D array of energy loss.</p></li>
<li><p><strong>L</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Window duration.</p></li>
<li><p><strong>m</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Parameter determining the window shape.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Kaiser window function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.gainpeakfitter.GainPeakFitter.lorentzian">
<span class="sig-name descname"><span class="pre">lorentzian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gam</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/gainpeakfitter.html#GainPeakFitter.lorentzian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.gainpeakfitter.GainPeakFitter.lorentzian" title="Link to this definition"></a></dt>
<dd><p>Lorentzian centered around <code class="docutils literal notranslate"><span class="pre">x</span></code> = <code class="docutils literal notranslate"><span class="pre">x0</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – 1D array of energy loss.</p></li>
<li><p><strong>x0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Energy loss at the center of the Lorentzian.</p></li>
<li><p><strong>a</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Height of the Lorentzian peak.</p></li>
<li><p><strong>gam</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – 2 * <code class="docutils literal notranslate"><span class="pre">gamma</span></code> is full width at half maximum (FWHM).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Lorentzian.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.gainpeakfitter.GainPeakFitter.lorentzian_background">
<span class="sig-name descname"><span class="pre">lorentzian_background</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/gainpeakfitter.html#GainPeakFitter.lorentzian_background"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.gainpeakfitter.GainPeakFitter.lorentzian_background" title="Link to this definition"></a></dt>
<dd><p>Lorentzian centered around <code class="docutils literal notranslate"><span class="pre">x</span></code> = <code class="docutils literal notranslate"><span class="pre">x0</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – 1D array of energy loss.</p></li>
<li><p><strong>x0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Energy loss at the center of the Lorentzian.</p></li>
<li><p><strong>a</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Height of the Lorentzian peak.</p></li>
<li><p><strong>gam</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – 2 * <code class="docutils literal notranslate"><span class="pre">gamma</span></code> is full width at half maximum (FWHM).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Lorentzian.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.gainpeakfitter.GainPeakFitter.model">
<span class="sig-name descname"><span class="pre">model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/gainpeakfitter.html#GainPeakFitter.model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.gainpeakfitter.GainPeakFitter.model" title="Link to this definition"></a></dt>
<dd><p>Calculates the ZLP model using the optimal fit parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – 1D array of energy loss.</p></li>
<li><p><strong>function</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>{'Gaussian'</em><em>, </em><em>'Split Gausian'</em><em>, </em><em>'Lorentzian'</em><em>, </em><em>'Pearson VII'</em><em>, </em><em>'Split Pearson VII'</em><em>, </em><em>'Pseudo-Voigt'</em><em>, </em><em>'Split Pseudo-Voigt'</em><em>, </em><em>'Generalised Peak'</em><em>, </em><em>'Kaiser window'}</em>) – Model choice for the ZLP.</p></li>
<li><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>ZLP model fit.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.gainpeakfitter.GainPeakFitter.model_fit_between">
<span class="sig-name descname"><span class="pre">model_fit_between</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Gaussian'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/gainpeakfitter.html#GainPeakFitter.model_fit_between"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.gainpeakfitter.GainPeakFitter.model_fit_between" title="Link to this definition"></a></dt>
<dd><p>Model fit of the ZLP. Delete x coordinates that contain information about gain/loss peaks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>{'Gaussian'</em><em>, </em><em>'Split Gausian'</em><em>, </em><em>'Lorentzian'</em><em>, </em><em>'Pearson VII'</em><em>, </em><em>'Split Pearson VII'</em><em>, </em><em>'Pseudo-Voigt'</em><em>, </em><em>'Split Pseudo-Voigt'</em><em>, </em><em>'Generalised Peak'</em><em>, </em><em>'Kaiser window'}</em>) – Model choice for the ZLP.</p></li>
<li><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>popt</strong> (<em>numpy.ndarray</em>) – Optimal values for the parameters so that the sum of the squared residuals of
f(xdata, <a href="#id5"><span class="problematic" id="id6">*</span></a>popt) - ydata is minimized.</p></li>
<li><p><strong>pcov</strong> (<em>numpy.ndarray</em>) – The estimated covariance of popt. The diagonals provide the  variance of the parameter estimates.
To compute one standard deviation errors on the parameters use perr = np.sqrt(np.diag(pcov)).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.gainpeakfitter.GainPeakFitter.pearson">
<span class="sig-name descname"><span class="pre">pearson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">I_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/gainpeakfitter.html#GainPeakFitter.pearson"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.gainpeakfitter.GainPeakFitter.pearson" title="Link to this definition"></a></dt>
<dd><p>Pearson VII function calculated as</p>
<div class="math notranslate nohighlight">
\[I(x, I_{\mathrm{max}}, x_0, w, m) = I_{\mathrm{max}} \frac{w^{2m}}{\left[w^2 + \left(2^\frac{1}{m} - 1 \right) \left(x - x_0 \right)^2 \right]^2}.\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – 1D array of energy loss.</p></li>
<li><p><strong>I_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Height of the peak.</p></li>
<li><p><strong>x_0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Energy loss at the center of the peak.</p></li>
<li><p><strong>w</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Parameter related to the width of the peak.</p></li>
<li><p><strong>m</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Parameter chosen to suit a particular peak shape.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Pearson VII function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.gainpeakfitter.GainPeakFitter.plot_all_results">
<span class="sig-name descname"><span class="pre">plot_all_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monte_carlo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/gainpeakfitter.html#GainPeakFitter.plot_all_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.gainpeakfitter.GainPeakFitter.plot_all_results" title="Link to this definition"></a></dt>
<dd><p>Plot all components: original signal, Model-fit ZLP, subtracted
spectrum, Lorentzian-fit gain peak.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.gainpeakfitter.GainPeakFitter.plot_array2D_of_intensity_at_energy_loss">
<span class="sig-name descname"><span class="pre">plot_array2D_of_intensity_at_energy_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eloss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'turbo'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'intensity'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm4_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/gainpeakfitter.html#GainPeakFitter.plot_array2D_of_intensity_at_energy_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.gainpeakfitter.GainPeakFitter.plot_array2D_of_intensity_at_energy_loss" title="Link to this definition"></a></dt>
<dd><p>Example heatmap plot: SI with only intensity at energy loss -1.1eV.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eloss</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – energy loss value. Defaults to -1.1.</p></li>
<li><p><strong>cmap</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – color map. Defaults to ‘turbo’.</p></li>
<li><p><strong>cbar_title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – color bar title. Defaults to ‘intensity’.</p></li>
<li><p><strong>dm4_filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – file name. Defaults to ‘’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>pyplot figure
ax:  pyplot axis</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>fig</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.gainpeakfitter.GainPeakFitter.pseudo_voigt">
<span class="sig-name descname"><span class="pre">pseudo_voigt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">I_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/gainpeakfitter.html#GainPeakFitter.pseudo_voigt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.gainpeakfitter.GainPeakFitter.pseudo_voigt" title="Link to this definition"></a></dt>
<dd><p>Linear combination of a Gaussian and Lorentzian function, both described by
the same FWHM <code class="docutils literal notranslate"><span class="pre">f</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – 1D array of energy loss.</p></li>
<li><p><strong>I_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Height of the peak.</p></li>
<li><p><strong>x_0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Energy loss at the center of the peak.</p></li>
<li><p><strong>f</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – FWHM.</p></li>
<li><p><strong>eta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Mixing parameter.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Pseudo-Voigt function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.gainpeakfitter.GainPeakFitter.signal_subtracted">
<span class="sig-name descname"><span class="pre">signal_subtracted</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Gaussian'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/gainpeakfitter.html#GainPeakFitter.signal_subtracted"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.gainpeakfitter.GainPeakFitter.signal_subtracted" title="Link to this definition"></a></dt>
<dd><p>Generate signal spectrum minus model fitted ZLP.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>{'Gaussian'</em><em>, </em><em>'Split Gausian'</em><em>, </em><em>'Lorentzian'</em><em>, </em><em>'Pearson VII'</em><em>, </em><em>'Split Pearson VII'</em><em>, </em><em>'Pseudo-Voigt'</em><em>, </em><em>'Split Pseudo-Voigt'</em><em>, </em><em>'Generalised Peak'</em><em>, </em><em>'Kaiser window'}</em>) – Model choice for the ZLP.</p></li>
<li><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1D array of signal spectrum minus model fitted ZLP.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.gainpeakfitter.GainPeakFitter.split_gaussian">
<span class="sig-name descname"><span class="pre">split_gaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_left</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_right</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/gainpeakfitter.html#GainPeakFitter.split_gaussian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.gainpeakfitter.GainPeakFitter.split_gaussian" title="Link to this definition"></a></dt>
<dd><p>Gaussian centered around <code class="docutils literal notranslate"><span class="pre">x</span></code> = <code class="docutils literal notranslate"><span class="pre">x0</span></code> with a different standard deviation for <code class="docutils literal notranslate"><span class="pre">x</span></code> &lt; <code class="docutils literal notranslate"><span class="pre">x0</span></code>
and <code class="docutils literal notranslate"><span class="pre">x</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">x0</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.ndrray</em>) – 1D array of the energy loss.</p></li>
<li><p><strong>x0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Energy loss at the center of the Gaussian.</p></li>
<li><p><strong>a</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Height of the Gaussian peak.</p></li>
<li><p><strong>sigma_left</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Standard deviation of the left half of the Gaussian.</p></li>
<li><p><strong>sigma_right</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Standard deviation of the right half of the Gaussian.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Split Gaussian.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.gainpeakfitter.GainPeakFitter.split_lorentzian">
<span class="sig-name descname"><span class="pre">split_lorentzian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gam_left</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gam_right</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/gainpeakfitter.html#GainPeakFitter.split_lorentzian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.gainpeakfitter.GainPeakFitter.split_lorentzian" title="Link to this definition"></a></dt>
<dd><p>Lorentzian centered around <code class="docutils literal notranslate"><span class="pre">x</span></code> = <code class="docutils literal notranslate"><span class="pre">x0</span></code> with a different FWHM for <code class="docutils literal notranslate"><span class="pre">x</span></code> &lt; <code class="docutils literal notranslate"><span class="pre">x0</span></code>
and <code class="docutils literal notranslate"><span class="pre">x</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">x0</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – 1D array of energy loss.</p></li>
<li><p><strong>x0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Energy loss at the center of the Lorentzian.</p></li>
<li><p><strong>a</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Height of the Lorentzian peak.</p></li>
<li><p><strong>gam_left</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – 2 * <code class="docutils literal notranslate"><span class="pre">gam_left</span></code> is full width at half maximum (FWHM) of the left half of the Lorentzian.</p></li>
<li><p><strong>gam_right</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – 2 * <code class="docutils literal notranslate"><span class="pre">gam_right</span></code> is full width at half maximum (FWHM) of the right half of the Lorentzian.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Split Lorentzian.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.gainpeakfitter.GainPeakFitter.split_pearson">
<span class="sig-name descname"><span class="pre">split_pearson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">I_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_left</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_right</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/gainpeakfitter.html#GainPeakFitter.split_pearson"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.gainpeakfitter.GainPeakFitter.split_pearson" title="Link to this definition"></a></dt>
<dd><p>Pearson VII function with a different <code class="docutils literal notranslate"><span class="pre">w</span></code> for <code class="docutils literal notranslate"><span class="pre">x</span></code> &lt; <code class="docutils literal notranslate"><span class="pre">x_0</span></code>
and <code class="docutils literal notranslate"><span class="pre">x</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">x_0</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – 1D array of energy loss.</p></li>
<li><p><strong>I_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Height of the peak.</p></li>
<li><p><strong>x_0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Energy loss at the center of the peak.</p></li>
<li><p><strong>w</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Parameter related to the width of the peak.</p></li>
<li><p><strong>m</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Parameter chosen to suit a particular peak shape.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Split Pearson VII function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EELSFitter.core.gainpeakfitter.GainPeakFitter.split_pseudo_voigt">
<span class="sig-name descname"><span class="pre">split_pseudo_voigt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">I_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_left</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_right</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/EELSFitter/core/gainpeakfitter.html#GainPeakFitter.split_pseudo_voigt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EELSFitter.core.gainpeakfitter.GainPeakFitter.split_pseudo_voigt" title="Link to this definition"></a></dt>
<dd><p>Pseudo-Voigt function with a different FWHM for <code class="docutils literal notranslate"><span class="pre">x</span></code> &lt; <code class="docutils literal notranslate"><span class="pre">x_0</span></code>
and <code class="docutils literal notranslate"><span class="pre">x</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">x_0</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – 1D array of energy loss.</p></li>
<li><p><strong>I_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Height of the peak.</p></li>
<li><p><strong>x_0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Energy loss at the center of the peak.</p></li>
<li><p><strong>f_left</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – FWHM for the left half of the function.</p></li>
<li><p><strong>f_right</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – FWHM for the right half of the function.</p></li>
<li><p><strong>eta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Mixing parameter.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Split Pseudo-Voigt function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

</section>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="EELSFitter.html" class="btn btn-neutral float-left" title="EELSFitter package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="EELSFitter.plotting.html" class="btn btn-neutral float-right" title="EELSFitter.plotting package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, EELSFitter developer team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>